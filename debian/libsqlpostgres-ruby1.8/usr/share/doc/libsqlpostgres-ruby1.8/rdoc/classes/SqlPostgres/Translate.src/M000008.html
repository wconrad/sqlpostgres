
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>sql_to_array2 (SqlPostgres::Translate)</title>
<link rel=StyleSheet href="../../.././rdoc-style.css" type="text/css" media="screen" />
</head>
<body bgcolor="white">
<pre><span class="cmt"># File ../lib/sqlpostgres/Translate.rb, line 230</span>
    <span class="kw">def</span> sql_to_array2(s)
      <span class="kw">if</span> s !~ <span class="re">/\A\{/</span>m
        raise ArgumentError
      <span class="kw">else</span>
        t = $'
        a = []
        loop <span class="kw">do</span>
          <span class="kw">case</span> t
          <span class="kw">when</span> <span class="re">/\A\},?/</span>
            <span class="kw">return</span> [a, $']
          <span class="kw">when</span> <span class="re">/\A\{/</span>
            e, t = sql_to_array2(t)
            a &lt;&lt; e
          <span class="kw">when</span> <span class="re">/\A([^&quot;][^\},]*),?/</span>m
            t = $' || <span class="str">&quot;&quot;</span>
            a &lt;&lt; $1
          <span class="kw">when</span> <span class="re">/\A&quot;((?:[^\\]|\\\\|\\&quot;)*?)&quot;,?/</span>m
            t = $' || <span class="str">&quot;&quot;</span>
            a &lt;&lt; $1.gsub(<span class="re">/\\\\/</span>, <span class="str">&quot;\\&quot;</span>).gsub(<span class="re">/\\&quot;/</span>, <span class="str">'&quot;'</span>)
          <span class="kw">else</span>
            raise ArgumentError
          <span class="kw">end</span>
        <span class="kw">end</span>
        a
      <span class="kw">end</span>
    <span class="kw">end</span></pre>
</body>
</html>